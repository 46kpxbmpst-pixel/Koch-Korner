<!doctype html>
<html lang="de"><head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Einfache Rezept-Sammlung (Baked)</title>
<style>
  :root{
    --bg:#f7f7f8;
    --panel:#ffffff;
    --text:#111827;
    --muted:#6b7280;
    --border:#e5e7eb;
    --accent:#2563eb;
    --radius:12px;
  }

  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    background:var(--bg);
    color:var(--text);
    font:15px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
  }

  .wrap{ max-width:900px; margin:auto; padding:20px 16px 28px; display:grid; gap:14px }

  .top{ position:sticky; top:0; z-index:2; background:linear-gradient(180deg,var(--bg) 85%,transparent); padding-top:4px; padding-bottom:8px }
  #q{ width:100%; padding:12px 14px; border-radius:var(--radius); border:1px solid var(--border); background:#fff; color:var(--text) }
  #q::placeholder{color:#9ca3af}
  #q:focus{ outline:2px solid var(--accent); outline-offset:2px }

  /* Kategorie-Leiste */
  .catbar{
    display:flex; gap:8px; flex-wrap:wrap; margin-top:8px
  }
  .catbtn{
    border:1px solid var(--border);
    background:#fff;
    color:var(--muted);
    border-radius:999px;
    padding:6px 10px;
    font-weight:600;
    cursor:pointer;
    transition: box-shadow .15s ease, border-color .12s ease, background .12s ease, color .12s ease;
    user-select:none;
  }
  .catbtn:hover{ box-shadow:0 4px 10px rgba(15,23,42,.08) }
  .catbtn.selected{
    background:var(--accent);
    color:#fff;
    border-color:transparent;
  }

  .list{ display:grid; gap:10px; margin-top:4px }
  .item{
    border:1px solid var(--border);
    border-radius:var(--radius);
    background:var(--panel);
    overflow:hidden;
    transition: border-color .12s ease, box-shadow .15s ease;
  }
  .item:hover{
    border-color:#d1d5db;
    box-shadow:0 6px 14px rgba(15,23,42,.08);
  }

  .title{
    width:100%; text-align:left; padding:12px 14px; cursor:pointer; background:transparent; color:var(--text); border:0; display:flex; gap:12px; align-items:center; justify-content:space-between; font-weight:600
  }
  .title:focus{ outline:2px solid var(--accent); outline-offset:2px; border-radius:calc(var(--radius) - 2px) }

  .left{ display:flex; gap:10px; align-items:center }
  .chev{ color:#9ca3af; transition:transform .15s ease, color .12s ease; font-size:12px }
  .item.open .chev{ transform:rotate(90deg); color:#6b7280 }

  .pill{ font-size:12px; padding:4px 8px; border:1px solid var(--border); border-radius:999px; color:var(--muted); background:#f3f4f6; white-space:nowrap }

  .content{ display:none; padding:12px 14px 14px; border-top:1px solid var(--border); white-space:pre-wrap; background:#fff }
  .item.open .content{ display:block }

  .empty{ color:var(--muted); text-align:center; padding:20px 12px }
  .empty .pill{ margin:4px }

  .new{ display:grid; gap:10px; border:1px dashed var(--border); border-radius:var(--radius); padding:12px; margin-top:6px; background:#fff }
  #newSection{ display:none }
  .new input,.new textarea{ width:100%; padding:10px 12px; border-radius:10px; border:1px solid var(--border); background:#fff; color:var(--text) }
  .new textarea{ min-height:110px; resize:vertical }

  .btn{ padding:9px 11px; border:1px solid var(--border); background:#ffffff; color:#111827; border-radius:10px; cursor:pointer; font-weight:600; transition: box-shadow .15s ease }
  .btn:hover{ box-shadow:0 4px 10px rgba(15,23,42,.08) }

  #toggleNewBtn{ margin-top:6px; text-align:center; background:var(--accent); color:#fff; border:none; border-radius:12px; font-weight:700; padding:11px 16px; cursor:pointer; transition: box-shadow .15s ease }
  #toggleNewBtn:hover{ box-shadow:0 8px 20px rgba(37,99,235,.3) }

  @media (max-width:520px){ .wrap{padding:16px 12px} }

  @media (prefers-color-scheme: dark){
    :root{ --bg:#0f1220; --panel:#0f172a; --text:#e5e7eb; --muted:#a1a1aa; --border:#1f273a; --accent:#3b82f6; }
    #q, .new, .content{ background:var(--panel) }
    .pill{ background:#111827; border-color:#1f273a }
    .btn{ background:#0f172a; color:var(--text) }
    .btn:hover{ box-shadow:0 6px 14px rgba(0,0,0,.35) }
    .catbtn{ background:#0f172a; color:#a1a1aa }
    .catbtn.selected{ background:var(--accent); color:#fff; border-color:transparent }
  }
</style>
</head>
<body>
  <div class="wrap">
    <div class="top">
      <input id="q" list="suggest" placeholder="Suche in Rezeptnamen, Texten &amp; Kategorien ‚Ä¶" autocomplete="off" aria-label="Suche">
      <datalist id="suggest"><option value="üå∂Ô∏è Chili con Carne"></option><option value="üçá Stachelbeertorte (nach Oma W√ºst)"></option><option value="üçé Gedeckte Apfeltorte"></option><option value="üçí Johannisbeerkuchen"></option><option value="üçù Bandnudeln mit Spinat-Sahne"></option><option value="üç´ Marmorkuchen"></option><option value="üçÆ K√§sekuchen Opa"></option><option value="üç∞ Buttermilchschnitten"></option><option value="üç∞ Streuselkuchen"></option><option value="ü•í R√∂mische Zucchini"></option><option value="ü•ï Kohlrabi in Kresse-Creme"></option><option value="ü•£ Hackfleisch-Sauerkrautsuppe"></option><option value="ü•¶ Gr√ºne Bohnen mit Knoblauch"></option><option value="ü•™ Partybr√∂tchen"></option><option value="Beilage"></option><option value="Hauptgericht"></option><option value="Kuchen und Torten"></option><option value="Snack"></option><option value="Suppe"></option></datalist>

      <!-- Kategorie-Leiste -->
      <div id="cats" class="catbar" aria-label="Kategorien"><button class="catbtn " data-cat="">Alle</button><button class="catbtn " data-cat="Beilage">Beilage</button><button class="catbtn " data-cat="Hauptgericht">Hauptgericht</button><button class="catbtn " data-cat="Kuchen und Torten">Kuchen und Torten</button><button class="catbtn " data-cat="Snack">Snack</button><button class="catbtn " data-cat="Suppe">Suppe</button></div>
    </div>

    <div class="list" id="list"><div class="empty">Bitte eine Kategorie ausw√§hlen (oder Suchbegriff eingeben).</div></div>

    <button id="toggleNewBtn">+ Neues Rezept hinzuf√ºgen</button>

    <section class="new" id="newSection" aria-labelledby="newTitle">
      <strong id="newTitle">Neues Rezept</strong>
      <input id="newT" placeholder="Rezeptname (Titel)">
      <input id="newCat" list="catList" placeholder="Kategorie (z. B. Hauptgericht)">
      <datalist id="catList">
        <option>Hauptgericht</option>
        <option>Vorspeise</option>
        <option>Dessert</option>
        <option>Beilage</option>
        <option>Fr√ºhst√ºck</option>
        <option>Snack</option>
        <option>Suppe</option>
        <option>Salat</option>
        <option>Kuchen und Torten</option>
      </datalist>
      <textarea id="newC" placeholder="Zutaten und Zubereitung ‚Ä¶"></textarea>
      <div style="display:flex; gap:8px; justify-content:flex-end">
        <button id="addBtn" class="btn">Hinzuf√ºgen</button>
      </div>

      <!-- Utility-Buttons -->
      <div style="display:flex; gap:8px; flex-wrap:wrap; margin-top:8px">
        <button id="importBtn" class="btn" title="JSON-Datei ausw√§hlen &amp; mergen">Rezepte importieren (JSON)</button>
        <input id="importFile" type="file" accept="application/json,.json" style="display:none">
        <button id="exportBtn" class="btn" title="Aktuellen Stand als JSON herunterladen">Rezepte exportieren (JSON)</button>
        <button id="resetBtn" class="btn" title="Lokalen Speicher l√∂schen &amp; eingebetteten Stand laden">Auf EMBEDDED zur√ºcksetzen</button>
        <button id="bakeBtn" class="btn" title="Erzeugt eine neue HTML-Datei mit eingebetteten Rezepten">Baked-HTML herunterladen</button>
      </div>
    </section>
  </div>

<script>
(function(){
  const KEY = 'simpleRecipes.baked.v3';
  const $ = id => document.getElementById(id);

  let notes = migrate(load());

  // Suche + Kategorie-Status
  let query = '';
  // null = nichts gew√§hlt (zeigt ohne Suchtext nichts), '' = ‚ÄûAlle‚Äú, sonst Kategoriename
  let selectedCat = null;

  const qEl = $('q'), listEl = $('list'), catsEl = $('cats');
  const suggestEl = $('suggest');
  const newT = $('newT'), newC = $('newC'), newCat = $('newCat'), addBtn = $('addBtn');
  const toggleBtn = $('toggleNewBtn'), newSection = $('newSection');

  // --- Storage & Seeds (Baked) ---
  function load(){
    const EMBEDDED = /*__EMBED_START__*/
[
  {
    "id": "oxd8eitfcv",
    "title": "üç∞ Streuselkuchen",
    "content": "‚è±Ô∏è Zubereitungszeit\n‚Ä¢ Aktive Zeit: ca. 30 Minuten\n‚Ä¢ Gehzeit: ca. 30 Minuten\n‚Ä¢ Backzeit: ca. 30 Minuten\n‚Ä¢ Gesamt: ca. 1¬Ω Stunden\n\nüçΩÔ∏è Portionen\nF√ºr 1 Blech\n\nüßÇ Zutaten\nHefeteig:\n‚Ä¢ 1 W√ºrfel Hefe\n‚Ä¢ 500 g Mehl\n‚Ä¢ ¬º l Milch\n‚Ä¢ 125 g Margarine\n‚Ä¢ 125 g Zucker\n‚Ä¢ 1 Prise Salz\n‚Ä¢ 1 Ei\nStreusel:\n‚Ä¢ 200 g Mehl\n‚Ä¢ 200 g Zucker\n‚Ä¢ 100 g Mondamin (oder Mehl)\n‚Ä¢ 200 g Butter\n‚Ä¢ 1 Prise Salz, 1 Prise Zimt\n\nüë©‚Äçüç≥ Zubereitung\n\t1. Mehl in Sch√ºssel geben, Vertiefung formen. Hefe in Milch mit Zucker aufl√∂sen, hineingeben, 15 Minuten gehen lassen.\n\t2. Restliche Zutaten einarbeiten, 15 Minuten gehen lassen.\n\t3. Streuselzutaten verkneten.\n\t4. Teig auf Blech ausrollen, ggf. mit Obst belegen, Streusel dar√ºber.\n\t5. Bei 180 ¬∞C ca. 30 Minuten backen.\n",
    "cat": "Kuchen und Torten",
    "updated": 1760177791083
  },
  {
    "id": "585k8ql9w2n",
    "title": "üçá Stachelbeertorte (nach Oma W√ºst)",
    "content": "‚è±Ô∏è Zubereitungszeit\n‚Ä¢ Aktive Zeit: ca. 45 Minuten\n‚Ä¢ Backzeit: ca. 30 Minuten\n‚Ä¢ K√ºhlzeit: ca. 1 Stunde\n‚Ä¢ Gesamt: ca. 2 Stunden 15 Minuten\n\nüçΩÔ∏è Portionen\nF√ºr 1 Torte (26 cm √ò)\n\nüßÇ Zutaten\nBoden:\n‚Ä¢ 100 g Butter\n‚Ä¢ 100 g Zucker\n‚Ä¢ 1 P√§ckchen Vanillezucker\n‚Ä¢ 4 Eigelb\n‚Ä¢ 1 TL Backpulver\n‚Ä¢ 125 g Mehl\nDeckel:\n‚Ä¢ 4 Eiwei√ü\n‚Ä¢ 150 g Zucker\n‚Ä¢ 100 g gehobelte Mandeln\nF√ºllung:\n‚Ä¢ 330 g Stachelbeeren (Glas)\n‚Ä¢ 1 Tortenguss klar\n‚Ä¢ 500 ml Sahne\n‚Ä¢ 2 P√§ckchen Vanillezucker\n‚Ä¢ 2 P√§ckchen Sahnesteif\n\nüë©‚Äçüç≥ Zubereitung\n\t1. Butter, Zucker, Vanillezucker cremig r√ºhren, Eigelb zugeben, Mehl und Backpulver einarbeiten.\n\t2. Auf 2 Formen verteilen.\n\t3. Eiwei√ü mit Zucker steif schlagen, aufstreichen, Mandeln daraufgeben.\n\t4. Bei 175 ¬∞C ca. 30 Minuten backen.\n\t5. Einen Boden mit Stachelbeeren und Tortenguss belegen, Sahne aufschlagen und daraufgeben.\nZweiten Boden in St√ºcke schneiden und als Deckel auflegen.",
    "cat": "Kuchen und Torten",
    "updated": 1760177691834
  },
  {
    "id": "xlgziq267u",
    "title": "üç´ Marmorkuchen",
    "content": "‚è±Ô∏è Zubereitungszeit\n‚Ä¢ Aktive Zeit: ca. 20 Minuten\n‚Ä¢ Backzeit: ca. 60 Minuten\n‚Ä¢ Gesamt: ca. 1 Stunde 20 Minuten\n\nüçΩÔ∏è Portionen\nF√ºr 1 Gugelhupfform\n\nüßÇ Zutaten\n‚Ä¢ 250 g Butter\n‚Ä¢ 250 g Zucker\n‚Ä¢ 4 Eier\n‚Ä¢ 350 g Mehl\n‚Ä¢ 1 P√§ckchen Backpulver\n‚Ä¢ 1 P√§ckchen Vanillezucker\n‚Ä¢ 1 EL Rum\n‚Ä¢ 250 ml Milch\n‚Ä¢ 3 EL Kakao\n‚Ä¢ Puderzucker\n\nüë©‚Äçüç≥ Zubereitung\n\t1. Butter, Zucker, Vanillezucker und Rum schaumig r√ºhren.\n\t2. Eier einzeln zugeben, Mehl und Backpulver mit Milch abwechselnd einr√ºhren.\n\t3. Teig halbieren, eine H√§lfte mit Kakao mischen.\n\t4. Hellen und dunklen Teig abwechselnd in Form geben, marmorieren.\n\t5. Bei 175 ¬∞C ca. 60 Minuten backen, abk√ºhlen lassen, mit Puderzucker bestreuen.\n",
    "cat": "Kuchen und Torten",
    "updated": 1760177635129
  },
  {
    "id": "rn2ef1m5zg",
    "title": "üçí Johannisbeerkuchen",
    "content": "‚è±Ô∏è Zubereitungszeit\n‚Ä¢ Aktive Zeit: ca. 25 Minuten\n‚Ä¢ Backzeit: ca. 30 Minuten\n‚Ä¢ Gesamt: ca. 55 Minuten\n\nüçΩÔ∏è Portionen\nF√ºr 1 Torte\n\nüßÇ Zutaten\nBoden:\n‚Ä¢ 4 Eier\n‚Ä¢ 125 g Zucker\n‚Ä¢ 180 g Mehl\n‚Ä¢ 9 EL √ñl\n‚Ä¢ ¬Ω P√§ckchen Backpulver\nBelag:\n‚Ä¢ Johannisbeeren nach Belieben\n‚Ä¢ 2 Becher Cr√®me fra√Æche\n‚Ä¢ 1 P√§ckchen Vanillezucker\n‚Ä¢ 2 Beutel Sahnesteif\n‚Ä¢ 60 g Puderzucker\n\nüë©‚Äçüç≥ Zubereitung\n\t1. Teigzutaten verr√ºhren, in gefettete Form geben.\n\t2. Bei 175 ¬∞C ca. 30 Minuten backen, abk√ºhlen lassen.\n\t3. Cr√®me fra√Æche mit Vanillezucker, Sahnesteif, Puderzucker verr√ºhren.\nJohannisbeeren unterheben und auf dem Boden verteilen.",
    "cat": "Kuchen und Torten",
    "updated": 1760177583660
  },
  {
    "id": "5zrfmr03cbx",
    "title": "üçÆ K√§sekuchen Opa",
    "content": "‚è±Ô∏è Zubereitungszeit\n‚Ä¢ Aktive Zeit: ca. 25 Minuten\n‚Ä¢ K√ºhlzeit: ca. 1 Stunde\n‚Ä¢ Backzeit: ca. 50‚Äì60 Minuten\n‚Ä¢ Gesamt: ca. 2¬Ω Stunden\n\nüçΩÔ∏è Portionen\nF√ºr eine Springform (26 cm √ò)\n\nüßÇ Zutaten\nTeig:\n‚Ä¢ 250 g Mehl\n‚Ä¢ 125 g Butter\n‚Ä¢ 30 g Zucker\n‚Ä¢ 1 Eigelb\n‚Ä¢ 1 Messerspitze Salz\n‚Ä¢ 2 EL Wasser\nF√ºllung:\n‚Ä¢ 750 g Quark (halb Mager-, halb Vollfettquark)\n‚Ä¢ ¬Ω Tasse √ñl\n‚Ä¢ 300 g Zucker\n‚Ä¢ 3 Eigelb\n‚Ä¢ 40 g Speisest√§rke\n‚Ä¢ 1 P√§ckchen Vanillezucker\n‚Ä¢ ‚Öõ l Milch\n‚Ä¢ 3‚Äì4 Eiwei√ü\n\nüë©‚Äçüç≥ Zubereitung\n\t1. Teigzutaten verkneten, 1 Stunde kalt stellen.\n\t2. Quarkmasse anr√ºhren, Eiwei√ü steif schlagen und unterheben.\n\t3. Teig ausrollen, Form auskleiden, F√ºllung einf√ºllen.\n\t4. Bei 180 ¬∞C ca. 50‚Äì60 Minuten backen.\nIm ausgeschalteten Ofen abk√ºhlen lassen.",
    "cat": "Kuchen und Torten",
    "updated": 1760177544114
  },
  {
    "id": "flo46e68pws",
    "title": "üç∞ Buttermilchschnitten",
    "content": "‚è±Ô∏è Zubereitungszeit\n‚Ä¢ Aktive Zeit: ca. 20 Minuten\n‚Ä¢ Backzeit: ca. 20 Minuten\n‚Ä¢ Gesamt: ca. 40 Minuten\n\nüçΩÔ∏è Portionen\nF√ºr 1 Blech\n\nüßÇ Zutaten\nTeig:\n‚Ä¢ 3 Eier\n‚Ä¢ 3 Tassen Zucker (nach Geschmack reduzieren)\n‚Ä¢ 1 P√§ckchen Vanillezucker\n‚Ä¢ 4 Tassen Mehl\n‚Ä¢ 1 P√§ckchen Backpulver\n‚Ä¢ 2 Tassen Buttermilch\nBelag:\n‚Ä¢ 2 Tassen Kokosflocken\n‚Ä¢ ¬Ω Tasse Zucker\nGuss:\n‚Ä¢ 200 g Sahne\n‚Ä¢ 150 g Butter\n\nüë©‚Äçüç≥ Zubereitung\n\t1. Eier, Zucker, Vanillezucker verr√ºhren. Mehl, Backpulver, Buttermilch zugeben.\n\t2. Auf Blech geben, mit Kokos-Zucker-Mischung bestreuen.\n\t3. Bei 180 ¬∞C ca. 20 Minuten backen.\nGuss aus Sahne und Butter kochen und √ºber den hei√üen Kuchen gie√üen.",
    "cat": "Kuchen und Torten",
    "updated": 1760177489675
  },
  {
    "id": "hv1wk5872oj",
    "title": "üçé Gedeckte Apfeltorte",
    "content": "‚è±Ô∏è Zubereitungszeit\n‚Ä¢ Aktive Zeit: ca. 25 Minuten\n‚Ä¢ Backzeit: ca. 70 Minuten\n‚Ä¢ Gesamt: ca. 1 Stunde 35 Minuten\n\nüçΩÔ∏è Portionen\nF√ºr eine Springform (26 cm √ò)\n\nüßÇ Zutaten\nTeig:\n‚Ä¢ 150 g Margarine\n‚Ä¢ 150 g Zucker\n‚Ä¢ 1 Ei\n‚Ä¢ 2 TL Backpulver\n‚Ä¢ 1 P√§ckchen Vanillezucker\n‚Ä¢ 300 g Mehl\nF√ºllung:\n‚Ä¢ ca. 1 kg √Ñpfel\n‚Ä¢ 1 Prise Zimt\n\nüë©‚Äçüç≥ Zubereitung\n\t1. √Ñpfel sch√§len, entkernen, w√ºrfeln und mit Zimt mischen.\n\t2. Zutaten f√ºr den Teig verkneten.\n\t3. ‚Öî Teig in Springform geben, Boden & Rand formen.\n\t4. √Ñpfel einf√ºllen, restlichen Teig ausrollen und als Deckel auflegen.\nBei 175 ¬∞C Umluft ca. 70 Minuten backen.",
    "cat": "Kuchen und Torten",
    "updated": 1760177446330
  },
  {
    "id": "sem5kah1b7h",
    "title": "ü•™ Partybr√∂tchen",
    "content": "‚è±Ô∏è Zubereitungszeit\n‚Ä¢ Aktive Zeit: ca. 10 Minuten\n‚Ä¢ Backzeit: ca. 15 Minuten\n‚Ä¢ Gesamt: ca. 25 Minuten\n\nüçΩÔ∏è Portionen\n6 Br√∂tchenh√§lften\n\nüßÇ Zutaten\n‚Ä¢ 1 Packung Br√∂tchen (6 St√ºck)\n‚Ä¢ 2 Becher Schmand\n‚Ä¢ 1 T√ºte geriebener K√§se\n‚Ä¢ Belag nach Geschmack: Salami, Schinken, Pilze, Ananas, Paprika, Zwiebeln\n\nüë©‚Äçüç≥ Zubereitung\n\t1. Schmand mit K√§se und Zutaten mischen.\n\t2. Auf Br√∂tchenh√§lften streichen.\nBei 180 ¬∞C ca. 15 Minuten goldbraun backen.",
    "cat": "Snack",
    "updated": 1760177371002
  },
  {
    "id": "9dbh70u6afj",
    "title": "ü•ï Kohlrabi in Kresse-Creme",
    "content": "‚è±Ô∏è Zubereitungszeit\n‚Ä¢ Aktive Zeit: ca. 20 Minuten\n‚Ä¢ Kochzeit: ca. 10 Minuten\n‚Ä¢ Gesamt: ca. 30 Minuten\n\nüçΩÔ∏è Portionen\nF√ºr 4 Personen\n\nüßÇ Zutaten\n‚Ä¢ 1 kg Kohlrabi (mit Herzbl√§ttern)\n‚Ä¢ 150 g Cr√®me fra√Æche\n‚Ä¢ 3 EL Kresse\n‚Ä¢ Salz, Pfeffer, Muskat\n‚Ä¢ Etwas Zitronensaft\n\nüë©‚Äçüç≥ Zubereitung\n\t1. Kohlrabi sch√§len, in Stifte schneiden. Herzbl√§tter fein schneiden.\n\t2. In Salzwasser 8‚Äì10 Minuten garen, abgie√üen.\n\t3. Cr√®me fra√Æche erhitzen, Kresse und Gew√ºrze einr√ºhren.\n\t4. Kohlrabi hinzuf√ºgen, abschmecken und servieren.\n",
    "cat": "Beilage",
    "updated": 1760177320203
  },
  {
    "id": "enl1ev4fogb",
    "title": "ü•¶ Gr√ºne Bohnen mit Knoblauch",
    "content": "‚è±Ô∏è Zubereitungszeit\n‚Ä¢ Aktive Zeit: ca. 10 Minuten\n‚Ä¢ Kochzeit: ca. 20 Minuten\n‚Ä¢ Gesamt: ca. 30 Minuten\n\nüçΩÔ∏è Portionen\nF√ºr 4 Personen\n\nüßÇ Zutaten\n‚Ä¢ 750 g gr√ºne Bohnen\n‚Ä¢ 150 g Cr√®me fra√Æche\n‚Ä¢ 2 Knoblauchzehen\n‚Ä¢ 1 EL Petersilie\n‚Ä¢ Salz und Pfeffer\n\nüë©‚Äçüç≥ Zubereitung\n\t1. Bohnen abf√§deln, waschen, in St√ºcke schneiden und 15 Minuten in Salzwasser garen.\n\t2. Cr√®me fra√Æche erhitzen, Knoblauch pressen, Petersilie zuf√ºgen.\n\t3. Mit Salz und Pfeffer w√ºrzen, Bohnen untermengen und kurz erhitzen.\n",
    "cat": "Beilage",
    "updated": 1760177285939
  },
  {
    "id": "j7nk6msqtg",
    "title": "ü•£ Hackfleisch-Sauerkrautsuppe",
    "content": "‚è±Ô∏è Zubereitungszeit\n‚Ä¢ Aktive Zeit: ca. 20 Minuten\n‚Ä¢ Kochzeit: ca. 60‚Äì90 Minuten\n‚Ä¢ Gesamt: ca. 1 Stunde 30 Minuten\n\nüçΩÔ∏è Portionen\nF√ºr 4 Personen\n\nüßÇ Zutaten\nF√ºr die Suppe:\n‚Ä¢ 2 gro√üe Zwiebeln\n‚Ä¢ 250 g Hackfleisch\n‚Ä¢ 2‚Äì3 Gew√ºrzgurken\n‚Ä¢ 3 geh√§ufte EL Sauerkraut\n‚Ä¢ 3 EL Tomatenmark\n‚Ä¢ 1 Liter Gem√ºse- oder Fleischbr√ºhe\n‚Ä¢ Salz und Pfeffer\n‚Ä¢ Petersilie oder Schnittlauch zum Verfeinern\nF√ºr den Dip:\n‚Ä¢ ¬Ω Becher saure Sahne\n‚Ä¢ 2‚Äì3 EL Mayonnaise\n‚Ä¢ 1‚Äì2 Knoblauchzehen\n‚Ä¢ 1 TL Senf\n‚Ä¢ Salz und Pfeffer\n\nüë©‚Äçüç≥ Zubereitung\n\t1. Zwiebeln und Hackfleisch in einem Topf anbraten. Mit Br√ºhe abl√∂schen und aufkochen.\n\t2. Gew√ºrzgurken, Tomatenmark und Sauerkraut hinzuf√ºgen. Ca. 1‚Äì2 Stunden k√∂cheln lassen.\n\t3. Mit Salz, Pfeffer und Kr√§utern abschmecken.\n\t4. F√ºr den Dip saure Sahne, Mayonnaise, Knoblauch und Senf verr√ºhren. Mit Salz und Pfeffer w√ºrzen und zur Suppe servieren.\n",
    "cat": "Suppe",
    "updated": 1760177236577
  },
  {
    "id": "rfxet4dtpmq",
    "title": "üçù Bandnudeln mit Spinat-Sahne",
    "content": "‚è±Ô∏è Zubereitungszeit\n‚Ä¢ Aktive Zeit: ca. 25 Minuten\n‚Ä¢ Gesamt: ca. 30 Minuten\n\nüçΩÔ∏è Portionen\nF√ºr 3 Portionen\n\nüßÇ Zutaten\n‚Ä¢ 500 g Blattspinat (frisch oder TK)\n‚Ä¢ 1 kleine Zwiebel\n‚Ä¢ 1 Knoblauchzehe\n‚Ä¢ 400 g Bandnudeln\n‚Ä¢ 1 EL √ñl\n‚Ä¢ 1 EL Pinienkerne (optional)\n‚Ä¢ 200 g Sahne\n‚Ä¢ Salz und Pfeffer\n‚Ä¢ 2 EL Parmesan\n\nüë©‚Äçüç≥ Zubereitung\n\t1. Spinat putzen. Nudeln in Salzwasser kochen.\n\t2. Zwiebel und Knoblauch in √ñl glasig d√ºnsten.\n\t3. Spinat und Pinienkerne zugeben, kurz mitd√ºnsten.\n\t4. Sahne hinzuf√ºgen, w√ºrzen und cremig einkochen.\nNudeln abgie√üen, unterheben, mit Parmesan servieren.",
    "cat": "Hauptgericht",
    "updated": 1760177196326
  },
  {
    "id": "l5p05ejgrks",
    "title": "üå∂Ô∏è Chili con Carne",
    "content": "‚è±Ô∏è Zubereitungszeit\n‚Ä¢ Aktive Zeit: ca. 20 Minuten\n‚Ä¢ Kochzeit: ca. 40 Minuten\n‚Ä¢ Gesamt: ca. 1 Stunde\n\nüçΩÔ∏è Portionen\nF√ºr 4 Personen\n\nüßÇ Zutaten\n‚Ä¢ 500 g Hackfleisch\n‚Ä¢ 500 ml passierte Tomaten\n‚Ä¢ 2 rote Paprika\n‚Ä¢ 2 gro√üe Zwiebeln\n‚Ä¢ 1 Dose Mais\n‚Ä¢ 2 Dosen Kidneybohnen\n‚Ä¢ 1 Packung Chili-Gew√ºrzmischung\n‚Ä¢ Salz, Pfeffer, Zucker oder Ketchup\n‚Ä¢ √ñl zum Braten\n\nüë©‚Äçüç≥ Zubereitung\n\t1. Hackfleisch in √ñl anbraten.\n\t2. Zwiebeln und Paprika zuf√ºgen, w√ºrzen.\n\t3. Tomaten, Bohnen und Gew√ºrze zugeben, 30‚Äì40 Minuten k√∂cheln lassen.\nMit Zucker oder Ketchup abschmecken, Mais kurz unterr√ºhren.",
    "cat": "Hauptgericht",
    "updated": 1760177123593
  },
  {
    "id": "alv69y4hz5w",
    "title": "ü•í R√∂mische Zucchini",
    "content": "‚è±Ô∏è Zubereitungszeit\n‚Ä¢ Aktive Zeit: ca. 25 Minuten\n‚Ä¢ Backzeit: ca. 25 Minuten\n‚Ä¢ Gesamt: ca. 50 Minuten\n\nüçΩÔ∏è Portionen\nF√ºr 2‚Äì3 Personen\n\nüßÇ Zutaten\n‚Ä¢ 50 g Speckw√ºrfel\n‚Ä¢ 1 EL √ñl\n‚Ä¢ 1 Zwiebel\n‚Ä¢ 1 Knoblauchzehe\n‚Ä¢ 500 g Tomatenso√üe\n‚Ä¢ 1 EL Oregano\n‚Ä¢ Salz und Pfeffer\n‚Ä¢ 500 g Zucchini\n‚Ä¢ 2 EL Semmelmehl\n‚Ä¢ 4‚Äì5 EL gehackte Kr√§uter (Petersilie, Oregano, Rosmarin)\n‚Ä¢ 40 g Parmesan\n‚Ä¢ 6 EL Sahne oder Cr√®me fra√Æche\n\nüë©‚Äçüç≥ Zubereitung\n\t1. Speck in √ñl anbraten, Zwiebel und Knoblauch zuf√ºgen und kurz and√ºnsten.\n\t2. Tomatenso√üe, Oregano, Salz und Pfeffer zugeben, eink√∂cheln lassen, in eine Auflaufform f√ºllen.\n\t3. Zucchini l√§ngs halbieren, leicht salzen.\n\t4. Semmelmehl, Kr√§uter, Parmesan und Sahne zu einer Paste verr√ºhren und auf die Zucchini streichen.\n\t5. In der So√üe bei 230 ¬∞C ca. 25 Minuten backen.\n",
    "cat": "Hauptgericht",
    "updated": 1760176576342
  }
]
/*__EMBED_END__*/;

    try{
      const raw = localStorage.getItem(KEY);
      if(!raw) return EMBEDDED;
      const arr = JSON.parse(raw);
      return Array.isArray(arr) ? arr : EMBEDDED;
    }catch(e){ console.warn(e); return EMBEDDED; }
  }

  function save(){
    localStorage.setItem(KEY, JSON.stringify(notes));
    refreshSuggestions();
    buildCategoryBar();
    render();
  }

  function mk(title, content, cat){
    return { id: Math.random().toString(36).slice(2), title: String(title||'Ohne Titel'), content: String(content||''), cat: String(cat||'Unkategorisiert'), updated: Date.now() };
  }

  function migrate(arr){
    return (arr||[]).map(n => ({
      id: n.id || Math.random().toString(36).slice(2),
      title: String(n.title||'Ohne Titel'),
      content: String(n.content||''),
      cat: n.cat ? String(n.cat) : 'Unkategorisiert',
      updated: Number(n.updated || Date.now())
    }));
  }

  // --- Vorschl√§ge f√ºllen (Titel + Kategorien) ---
  function refreshSuggestions(){
    const titleSet = new Set(notes.map(n => n.title).filter(Boolean));
    const catSet   = new Set(notes.map(n => n.cat || 'Unkategorisiert'));
    const options = Array.from(new Set([...titleSet, ...catSet]))
      .sort((a,b)=>a.localeCompare(b,'de',{sensitivity:'base'}));
    suggestEl.innerHTML = options.map(v => `<option value="${escapeAttr(v)}"></option>`).join('');
  }

  // Merge-Helfer (f√ºr Import & optionales Laden)
  function mergeIncoming(fileArr){
    const incoming = migrate(fileArr || []);
    const key = r => (r.title||'').trim().toLowerCase()+'|'+(r.cat||'').trim().toLowerCase();
    const map = new Map(notes.map(r => [key(r), r]));
    for(const r of incoming){
      const k = key(r);
      if(!map.has(k)){
        map.set(k, {...r, id: r.id || Math.random().toString(36).slice(2), updated: r.updated || Date.now()});
      }
    }
    notes = Array.from(map.values()).sort((a,b)=>b.updated - a.updated);
    save();
  }

  // --- Kategorie-Leiste ---
  function buildCategoryBar(){
    const cats = Array.from(new Set(notes.map(n => n.cat || 'Unkategorisiert')))
      .sort((a,b)=>a.localeCompare(b,'de',{sensitivity:'base'}));
    const allBtn = `<button class="catbtn ${selectedCat===''? 'selected':''}" data-cat="">Alle</button>`;
    const catBtns = cats.map(c =>
      `<button class="catbtn ${selectedCat===c?'selected':''}" data-cat="${escapeAttr(c)}">${escapeHtml(c)}</button>`
    ).join('');
    catsEl.innerHTML = allBtn + catBtns;
  }

  catsEl.addEventListener('click', (e)=>{
    const btn = e.target.closest('.catbtn');
    if(!btn) return;
    const clicked = btn.getAttribute('data-cat'); // '' f√ºr Alle, sonst Kategoriename
    selectedCat = (clicked === selectedCat) ? null : clicked; // erneuter Klick -> abw√§hlen
    buildCategoryBar();
    render();
  });

  // --- Render (mit Suche-zeigt-auch-ohne-Kategorie) ---
  function render(){
    const q = query.trim().toLowerCase();

    // Nichts ausgew√§hlt + keine Suche => nichts anzeigen (Hinweis)
    if (selectedCat === null && q === '') {
      listEl.innerHTML = `<div class="empty">Bitte eine Kategorie ausw√§hlen (oder Suchbegriff eingeben).</div>`;
      return;
    }

    const list = notes
      .slice()
      .sort((a,b)=>b.updated - a.updated)
      .filter(n => {
        const matchesQuery = q === '' ? true : (
          n.title.toLowerCase().includes(q) ||
          n.content.toLowerCase().includes(q) ||
          (n.cat||'').toLowerCase().includes(q)
        );
        // Kategorie aktiv? (null = keine, '' = Alle)
        const catActive = (selectedCat !== null && selectedCat !== '');
        const matchesCat = catActive ? (n.cat === selectedCat) : true;
        return matchesQuery && matchesCat;
      });

    listEl.innerHTML = '';

    if(list.length===0){
      listEl.innerHTML = `<div class="empty">Keine Treffer.</div>`;
      return;
    }

    for(const n of list){
      const item = document.createElement('div');
      item.className = 'item';

      // NEU: Gesamtzeit aus dem Inhalt parsen
      const totalTime = getTotalTime(n.content);

      item.innerHTML = `
        <button class="title" aria-expanded="false">
          <span class="left">
            <span class="chev">‚ñ∂</span>
            <strong>${escapeHtml(n.title||'Ohne Titel')}</strong>
          </span>
          <span style="display:flex; gap:8px; align-items:center">
            ${ totalTime ? `<span class="pill" title="Gesamtzeit">‚è± ${escapeHtml(totalTime)}</span>` : '' }
            <span class="pill" title="Kategorie">${escapeHtml(n.cat||'Unkategorisiert')}</span>
          </span>
        </button>
        <div class="content">${escapeHtml(n.content).replace(/\n/g,'<br>')}</div>
      `;
      const btn = item.querySelector('.title');
      btn.addEventListener('click', ()=>{
        const open = item.classList.toggle('open');
        btn.setAttribute('aria-expanded', String(open));
      });
      listEl.appendChild(item);
    }
  }

  // --- Utils ---
  function escapeHtml(s=''){ return s.replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }
  function escapeAttr(s=''){ return String(s).replace(/"/g,'&quot;'); }

  // NEU: Zeit aus "Gesamt:" oder "Gesammt:" Zeile lesen
  function getTotalTime(text=''){
    const m = String(text).match(/^\s*(?:Gesamt|Gesammt)\s*:\s*(.+)$/im);
    return m ? m[1].trim() : null; // z.B. "45 Min", "1:15 h", "1 h 30 min"
  }

  // --- Events ---
  qEl.addEventListener('input', e=>{ query = e.target.value; render(); });
  qEl.addEventListener('keydown', e=>{ if(e.key === 'Enter'){ query = qEl.value; render(); } });

  addBtn.addEventListener('click', ()=>{
    const t = newT.value.trim();
    const c = newC.value;
    const cat = (newCat.value || 'Unkategorisiert').trim();
    if(!t && !c) return;
    notes.unshift(mk(t, c, cat));
    newT.value=''; newC.value=''; newCat.value='';
    save();

    if(newSection.style.display !== 'none'){
      newSection.style.display = 'none';
      toggleBtn.textContent = '+ Neues Rezept hinzuf√ºgen';
    }
  });

  toggleBtn.addEventListener('click', ()=>{
    const isHidden = newSection.style.display === 'none' || !newSection.style.display;
    newSection.style.display = isHidden ? 'grid' : 'none';
    toggleBtn.textContent = isHidden ? '‚Äì Formular ausblenden' : '+ Neues Rezept hinzuf√ºgen';
  });

  // --- Import (Datei ausw√§hlen & mergen) ---
  $('importBtn').addEventListener('click', ()=> $('importFile').click());
  $('importFile').addEventListener('change', async (e)=>{
    const file = e.target.files && e.target.files[0];
    if(!file) return;
    try{
      const text = await file.text();
      const json = JSON.parse(text);
      if(!Array.isArray(json)) throw new Error('Datei ist kein Array von Rezepten.');
      mergeIncoming(json);
    }catch(err){
      alert('Import fehlgeschlagen: '+err.message);
      console.error(err);
    }finally{
      e.target.value = '';
    }
  });

  // --- Export: aktuellen Stand als JSON herunterladen ---
  $('exportBtn').addEventListener('click', () => {
    const blob = new Blob([JSON.stringify(notes, null, 2)], {type:'application/json'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'recipes.json';
    a.click();
    URL.revokeObjectURL(url);
  });

  // --- Reset: lokalen Speicher l√∂schen & Seite neu laden (zeigt EMBEDDED) ---
  $('resetBtn').addEventListener('click', () => {
    localStorage.removeItem(KEY);
    location.reload();
  });

  // --- Bake: komplette HTML mit EMBEDDED erzeugen & downloaden ---
  $('bakeBtn').addEventListener('click', () => {
    try{
      let html = '<!doctype html>\n' + document.documentElement.outerHTML;
      const embeddedJson = JSON.stringify(notes, null, 2);
      const embedRegex =
        /(const\s+EMBEDDED\s*=\s*\/\*__EMBED_START__\*\/)([\s\S]*?)(\/\*__EMBED_END__\*\/\s*;?)/;

      if(!embedRegex.test(html)){
        alert('EMBEDDED-Marker nicht gefunden. Bitte Funktion load() pr√ºfen.');
        return;
      }
      html = html.replace(
        embedRegex,
        (_, start, _old, end) => `${start}\n${embeddedJson}\n${end}`
      );

      html = html.replace(
        /(const\s+KEY\s*=\s*['"])([^'"]*?\.baked\.v)(\d+)(['"]\s*;)/,
        (m, p1, base, num, p4) => p1 + base + (Number(num)+1) + p4
      );

      const blob = new Blob([html], {type:'text/html'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'rezepte_baked.html';
      a.click();
      URL.revokeObjectURL(url);
    }catch(err){
      console.error(err);
      alert('Konnte Baked-HTML nicht erzeugen. Siehe Konsole.');
    }
  });

  // --- Start ---
  refreshSuggestions();
  buildCategoryBar();
  render();
})();
</script>



</body></html>
